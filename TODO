* Refactor Emitter::Send, it is ugly.
* Remove duplicated logic with empty or non empty bodies
* Handle kwbegin and begin separately
